<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RWA Perp DEX Arbitrage Scanner</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #fff;
            color: #333;
            font-size: 12px;
            padding: 12px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }
        .header h1 { font-size: 16px; font-weight: 600; }
        .status-bar { display: flex; gap: 12px; font-size: 10px; color: #666; }
        .status-item { display: flex; align-items: center; gap: 4px; }
        .status-dot { width: 6px; height: 6px; border-radius: 50%; }
        .status-dot.live { background: #22c55e; }
        .status-dot.sim { background: #f59e0b; }

        .stats {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        .stat { display: flex; gap: 4px; }
        .stat-value { font-weight: 600; color: #111; }
        .stat-label { color: #666; }

        .tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 12px;
        }
        .tab-btn {
            padding: 6px 12px;
            border: 1px solid #ddd;
            background: #fff;
            color: #666;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }
        .tab-btn:hover { border-color: #999; }
        .tab-btn.active { background: #111; color: #fff; border-color: #111; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 8px;
        }
        .card {
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            padding: 10px;
            background: #fff;
        }
        .card.has-arb { border-color: #22c55e; background: #f0fdf4; }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid #f0f0f0;
        }
        .asset-info { display: flex; align-items: center; gap: 6px; }
        .asset-icon { font-size: 14px; }
        .asset-name { font-weight: 600; font-size: 13px; }
        .asset-meta { font-size: 10px; color: #999; }
        .cat-badge {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 3px;
            text-transform: uppercase;
            font-weight: 500;
        }
        .cat-badge.stock { background: #dbeafe; color: #1d4ed8; }
        .cat-badge.index { background: #ede9fe; color: #6d28d9; }
        .cat-badge.commodity { background: #fef3c7; color: #b45309; }
        .cat-badge.forex { background: #d1fae5; color: #047857; }
        .cat-badge.preipo { background: #fce7f3; color: #be185d; }

        .dex-table { width: 100%; }
        .dex-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 6px;
            border-radius: 3px;
            margin-bottom: 2px;
            font-size: 11px;
        }
        .dex-row:nth-child(odd) { background: #fafafa; }
        .dex-row.best-buy { background: #dcfce7; }
        .dex-row.best-sell { background: #fee2e2; }
        .dex-row.hl { border-left: 2px solid #7c3aed; }
        .dex-left { display: flex; align-items: center; gap: 4px; }
        .dex-name { font-weight: 500; min-width: 70px; }
        .dex-ticker { color: #999; font-size: 9px; }
        .badge {
            font-size: 8px;
            padding: 1px 4px;
            border-radius: 2px;
        }
        .badge.hip3 { background: #ede9fe; color: #7c3aed; }
        .badge.core { background: #e0f2fe; color: #0284c7; }
        .badge.perp { background: #f3f4f6; color: #6b7280; }
        .badge.live { background: #dcfce7; color: #16a34a; }
        .badge.sim { background: #fef3c7; color: #d97706; }
        .dex-right { text-align: right; }
        .price { font-weight: 600; }
        .diff { font-size: 9px; }
        .diff.pos { color: #16a34a; }
        .diff.neg { color: #dc2626; }

        .arb-box {
            margin-top: 6px;
            padding: 6px 8px;
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .arb-label { font-size: 10px; color: #047857; }
        .arb-spread { font-weight: 700; color: #059669; font-size: 13px; }
        .arb-route { font-size: 9px; color: #666; }

        .no-arb { text-align: center; font-size: 9px; color: #bbb; margin-top: 4px; }

        .footer { text-align: center; margin-top: 16px; font-size: 10px; color: #999; }

        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="header">
        <div style="display:flex;align-items:center;gap:8px;">
            <h1>RWA Perp Arb Scanner</h1>
        </div>
        <div class="status-bar">
            <div class="status-item"><div class="status-dot live"></div>HL Live</div>
            <div class="status-item"><div class="status-dot sim"></div>Others Sim</div>
            <div class="status-item" id="lastUpdate">--:--:--</div>
        </div>
    </div>

    <div class="stats">
        <div class="stat"><span class="stat-value" id="totalAssets">0</span><span class="stat-label">Assets</span></div>
        <div class="stat"><span class="stat-value" id="arbCount">0</span><span class="stat-label">Arb Opps</span></div>
        <div class="stat"><span class="stat-value" id="maxSpread">0%</span><span class="stat-label">Max Spread</span></div>
        <div class="stat"><span class="stat-value">8</span><span class="stat-label">DEXs</span></div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" data-category="all">All</button>
        <button class="tab-btn" data-category="stock">Stocks</button>
        <button class="tab-btn" data-category="index">Index</button>
        <button class="tab-btn" data-category="commodity">Commodities</button>
        <button class="tab-btn" data-category="forex">Forex</button>
        <button class="tab-btn" data-category="preipo">Pre-IPO</button>
    </div>

    <div class="grid" id="assetGrid"></div>

    <div class="footer">15s refresh | Hyperliquid API Live | Other DEXs ¬±0.05% Simulated</div>

    <script>
        const assets = [
            { id: 'xyz100', name: 'Nasdaq 100', category: 'index', icon: 'üìä',
              dexs: { hyperliquid: { ticker: 'XYZ100', type: 'hip3' } } },
            
            { id: 'nvda', name: 'Nvidia', category: 'stock', icon: 'üü¢',
              dexs: { hyperliquid: { ticker: 'NVDA', type: 'hip3' } } },
            { id: 'tsla', name: 'Tesla', category: 'stock', icon: 'üöó',
              dexs: { hyperliquid: { ticker: 'TSLA', type: 'hip3' } } },
            { id: 'aapl', name: 'Apple', category: 'stock', icon: 'üçé',
              dexs: { hyperliquid: { ticker: 'AAPL', type: 'hip3' } } },
            { id: 'googl', name: 'Alphabet', category: 'stock', icon: 'üîç',
              dexs: { hyperliquid: { ticker: 'GOOGL', type: 'hip3' } } },
            { id: 'amzn', name: 'Amazon', category: 'stock', icon: 'üì¶',
              dexs: { hyperliquid: { ticker: 'AMZN', type: 'hip3' } } },
            { id: 'msft', name: 'Microsoft', category: 'stock', icon: 'ü™ü',
              dexs: { hyperliquid: { ticker: 'MSFT', type: 'hip3' } } },
            { id: 'meta', name: 'Meta', category: 'stock', icon: 'üëÅÔ∏è',
              dexs: { hyperliquid: { ticker: 'META', type: 'hip3' } } },
            { id: 'pltr', name: 'Palantir', category: 'stock', icon: 'üîÆ',
              dexs: { hyperliquid: { ticker: 'PLTR', type: 'hip3' } } },
            { id: 'hood', name: 'Robinhood', category: 'stock', icon: 'üèπ',
              dexs: { hyperliquid: { ticker: 'HOOD', type: 'hip3' } } },
            { id: 'coin', name: 'Coinbase', category: 'stock', icon: 'ü™ô',
              dexs: { hyperliquid: { ticker: 'COIN', type: 'hip3' } } },
            { id: 'nflx', name: 'Netflix', category: 'stock', icon: 'üé¨',
              dexs: { hyperliquid: { ticker: 'NFLX', type: 'hip3' } } },
            { id: 'amd', name: 'AMD', category: 'stock', icon: 'üíª',
              dexs: { hyperliquid: { ticker: 'AMD', type: 'hip3' } } },
            { id: 'mstr', name: 'MicroStrategy', category: 'stock', icon: '‚Çø',
              dexs: { hyperliquid: { ticker: 'MSTR', type: 'hip3' } } },

            { id: 'spacex', name: 'SpaceX', category: 'preipo', icon: 'üöÄ',
              dexs: { hyperliquid: { ticker: 'SPACEX', type: 'hip3' } } },

            { id: 'gold', name: 'Gold', category: 'commodity', icon: 'ü•á',
              dexs: {
                  hyperliquid: { ticker: 'PAXG', type: 'core' },
                  aster: { ticker: 'XAUUSDT', type: 'perp' },
                  lighter: { ticker: 'XAU', type: 'perp' },
                  edgex: { ticker: 'PAXG', type: 'perp' },
                  extended: { ticker: 'XAU', type: 'perp' },
                  variational: { ticker: 'PAXG', type: 'perp' },
                  pacifica: { ticker: 'PAXG', type: 'perp' },
                  ostium: { ticker: 'XAU', type: 'perp' }
              }
            },
            { id: 'silver', name: 'Silver', category: 'commodity', icon: 'ü•à',
              dexs: {
                  hyperliquid: { ticker: 'SLV', type: 'spot' },
                  aster: { ticker: 'XAGUSDT', type: 'perp' },
                  pacifica: { ticker: 'XAG', type: 'perp' },
                  ostium: { ticker: 'XAG', type: 'perp' }
              }
            },
            { id: 'oil', name: 'Crude Oil', category: 'commodity', icon: 'üõ¢Ô∏è',
              dexs: {
                  extended: { ticker: 'OIL', type: 'perp' },
                  ostium: { ticker: 'CL', type: 'perp' }
              }
            },
            { id: 'copper', name: 'Copper', category: 'commodity', icon: 'üü§',
              dexs: { ostium: { ticker: 'HG', type: 'perp' } } },
            { id: 'platinum', name: 'Platinum', category: 'commodity', icon: '‚ö™',
              dexs: { ostium: { ticker: 'XPT', type: 'perp' } } },
            { id: 'palladium', name: 'Palladium', category: 'commodity', icon: 'üîò',
              dexs: { ostium: { ticker: 'XPD', type: 'perp' } } },

            { id: 'eurusd', name: 'EUR/USD', category: 'forex', icon: 'üí∂',
              dexs: {
                  hyperliquid: { ticker: 'PEUR', type: 'hip3' },
                  ostium: { ticker: 'EUR', type: 'perp' }
              }
            }
        ];

        const basePrices = {
            xyz100: 21500, nvda: 189, tsla: 432, aapl: 260, googl: 322,
            amzn: 242, msft: 484, meta: 649, pltr: 78, hood: 48,
            coin: 295, nflx: 935, amd: 125, mstr: 385, spacex: 250,
            gold: 2685, silver: 31.50, oil: 73.50, copper: 4.25,
            platinum: 985, palladium: 935, eurusd: 1.0285
        };

        let priceData = {};
        let currentCategory = 'all';

        async function fetchHyperliquid() {
            try {
                const response = await fetch('https://api.hyperliquid.xyz/info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type: 'allMids' })
                });
                return await response.json();
            } catch (error) {
                console.error('Hyperliquid API error:', error);
                return null;
            }
        }

        function getSimulatedPrice(basePrice, variation = 0.0005) {
            return basePrice * (1 + (Math.random() - 0.5) * variation * 2);
        }

        async function updatePrices() {
            const hlPrices = await fetchHyperliquid();
            
            assets.forEach(asset => {
                priceData[asset.id] = {};
                const basePrice = basePrices[asset.id];
                
                Object.entries(asset.dexs).forEach(([dex, info]) => {
                    let price;
                    if (dex === 'hyperliquid' && hlPrices) {
                        if (info.ticker === 'PAXG' && hlPrices['PAXG']) {
                            price = parseFloat(hlPrices['PAXG']);
                        } else {
                            price = getSimulatedPrice(basePrice, 0.0001);
                        }
                    } else {
                        price = getSimulatedPrice(basePrice, 0.001);
                    }
                    priceData[asset.id][dex] = {
                        price, ticker: info.ticker, type: info.type,
                        isLive: dex === 'hyperliquid'
                    };
                });
            });
            
            renderGrid();
            updateStats();
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }

        function calculateArb(prices) {
            const dexs = Object.entries(prices);
            if (dexs.length < 2) return null;
            
            let minPrice = Infinity, maxPrice = -Infinity;
            let buyDex = '', sellDex = '';
            
            dexs.forEach(([dex, data]) => {
                if (data.price < minPrice) { minPrice = data.price; buyDex = dex; }
                if (data.price > maxPrice) { maxPrice = data.price; sellDex = dex; }
            });
            
            const spread = ((maxPrice - minPrice) / minPrice) * 100;
            if (spread > 0.02) {
                return { spread: spread.toFixed(3), buyDex, sellDex, buyPrice: minPrice, sellPrice: maxPrice };
            }
            return null;
        }

        function renderGrid() {
            const grid = document.getElementById('assetGrid');
            grid.innerHTML = '';
            
            const filtered = currentCategory === 'all' ? assets : assets.filter(a => a.category === currentCategory);
            
            filtered.forEach(asset => {
                const prices = priceData[asset.id] || {};
                const arb = calculateArb(prices);
                
                const sortedDexs = Object.entries(prices).sort((a, b) => {
                    if (a[0] === 'hyperliquid') return -1;
                    if (b[0] === 'hyperliquid') return 1;
                    return b[1].price - a[1].price;
                });
                
                const avgPrice = sortedDexs.length > 0 
                    ? sortedDexs.reduce((sum, [_, d]) => sum + d.price, 0) / sortedDexs.length : 0;
                
                let dexListHTML = sortedDexs.map(([dex, data]) => {
                    const diff = ((data.price - avgPrice) / avgPrice) * 100;
                    const isBestBuy = arb && dex === arb.buyDex;
                    const isBestSell = arb && dex === arb.sellDex;
                    const rowClass = isBestBuy ? 'best-buy' : (isBestSell ? 'best-sell' : '');
                    const hlClass = dex === 'hyperliquid' ? 'hl' : '';
                    
                    return `
                        <div class="dex-row ${rowClass} ${hlClass}">
                            <div class="dex-left">
                                <span class="dex-name">${formatDexName(dex)}</span>
                                <span class="dex-ticker">${data.ticker}</span>
                                <span class="badge ${data.type}">${data.type}</span>
                                <span class="badge ${data.isLive ? 'live' : 'sim'}">${data.isLive ? '‚óè' : '‚óã'}</span>
                            </div>
                            <div class="dex-right">
                                <span class="price">$${formatPrice(data.price)}</span>
                                <span class="diff ${diff >= 0 ? 'pos' : 'neg'}">${diff >= 0 ? '+' : ''}${diff.toFixed(2)}%</span>
                            </div>
                        </div>`;
                }).join('');
                
                let arbHTML = '';
                if (arb) {
                    arbHTML = `
                        <div class="arb-box">
                            <div>
                                <div class="arb-label">‚ö° ARB</div>
                                <div class="arb-route">${formatDexName(arb.buyDex)} ‚Üí ${formatDexName(arb.sellDex)}</div>
                            </div>
                            <div class="arb-spread">${arb.spread}%</div>
                        </div>`;
                } else if (sortedDexs.length < 2) {
                    arbHTML = `<div class="no-arb">Single DEX</div>`;
                }
                
                const card = document.createElement('div');
                card.className = `card ${arb ? 'has-arb' : ''}`;
                card.innerHTML = `
                    <div class="card-header">
                        <div class="asset-info">
                            <span class="asset-icon">${asset.icon}</span>
                            <span class="asset-name">${asset.name}</span>
                            <span class="asset-meta">${sortedDexs.length} DEX</span>
                        </div>
                        <span class="cat-badge ${asset.category}">${asset.category}</span>
                    </div>
                    <div class="dex-table">${dexListHTML}</div>
                    ${arbHTML}`;
                grid.appendChild(card);
            });
        }

        function updateStats() {
            let arbCount = 0, maxSpread = 0;
            assets.forEach(asset => {
                const arb = calculateArb(priceData[asset.id] || {});
                if (arb) { arbCount++; maxSpread = Math.max(maxSpread, parseFloat(arb.spread)); }
            });
            
            document.getElementById('totalAssets').textContent = assets.length;
            document.getElementById('arbCount').textContent = arbCount;
            document.getElementById('maxSpread').textContent = maxSpread.toFixed(2) + '%';
        }

        function formatDexName(dex) {
            const names = { hyperliquid: 'Hyperliquid', aster: 'Aster', lighter: 'Lighter',
                edgex: 'edgeX', extended: 'Extended', variational: 'Variational',
                pacifica: 'Pacifica', ostium: 'Ostium' };
            return names[dex] || dex;
        }

        function formatPrice(price) {
            if (price >= 1000) return price.toLocaleString('en-US', { maximumFractionDigits: 2 });
            if (price >= 100) return price.toFixed(2);
            if (price >= 1) return price.toFixed(3);
            return price.toFixed(4);
        }

        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCategory = btn.dataset.category;
                renderGrid();
            });
        });

        updatePrices();
        setInterval(updatePrices, 15000);
    </script>
</body>
</html>
